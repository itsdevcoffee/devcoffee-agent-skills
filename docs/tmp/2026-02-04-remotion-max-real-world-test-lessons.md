# Remotion Max - Real World Test: Lessons Learned

**Date:** 2026-02-04
**Test:** Creating a 15-second explainer video for Dev Coffee marketplace
**Result:** FAILED on first attempt - Multiple critical issues found
**Status:** Issues identified, fixes applied, improvements documented

---

## Executive Summary

**Goal:** Use remotion-max plugin to create a polished 15-second explainer video

**Outcome:** Video rendered as black screen with tiny coffee emoji in top-left corner

**Root Cause:** Multiple fundamental issues in remotion-setup and remotion-builder agents that prevented proper video rendering

**Impact:** This validates the plugin-dev:agent-creator assessment that system prompts were "too brief for effective code generation"

---

## Critical Failures

### 1. Missing CSS Import (CRITICAL)

**Issue:** The remotion-setup agent created `src/index.tsx` without importing `style.css`

**Impact:** Tailwind CSS never loaded, all Tailwind classes ignored

**What happened:**
```tsx
// Generated by remotion-setup
import {registerRoot} from 'remotion';
import {RemotionRoot} from './Root';

registerRoot(RemotionRoot);
// ❌ Missing: import './style.css';
```

**Why it's critical:**
- Without CSS import, Tailwind doesn't process
- All component styling fails
- Background gradients don't render → black screen
- Text colors don't apply → invisible text
- Layout classes don't work → content in wrong position

**Fix applied:**
```tsx
import {registerRoot} from 'remotion';
import {RemotionRoot} from './Root';
import './style.css';  // ✅ ADDED

registerRoot(RemotionRoot);
```

**Lesson:** Entry point MUST import CSS for Tailwind to work

---

### 2. Missing Flex Class on AbsoluteFill (CRITICAL)

**Issue:** The remotion-builder agent used `items-center justify-center` without `flex` class

**Impact:** Centering didn't work, content appeared in top-left corner

**What happened:**
```tsx
// Generated by remotion-builder
<AbsoluteFill className="bg-gradient-to-br from-coffee-900 to-coffee-800 items-center justify-center">
// ❌ Missing 'flex' class
```

**Why it's critical:**
- `items-center` and `justify-center` are flexbox utilities
- Without `display: flex`, they do nothing
- Content uses default positioning (top-left)
- Results in tiny emoji in corner instead of centered content

**Fix applied to all 4 components:**
```tsx
<AbsoluteFill className="flex bg-gradient-to-br from-coffee-900 to-coffee-800 items-center justify-center">
// ✅ ADDED 'flex'
```

**Lesson:** Flexbox utilities require `flex` class

---

### 3. Invalid Concurrency Configuration (BLOCKING)

**Issue:** remotion.config.ts set concurrency to 50 on a 16-core system

**Impact:** Build completely failed with error before rendering

**What happened:**
```typescript
// Generated by remotion-setup
Config.setConcurrency(50);
// ❌ System only has 16 cores
```

**Error message:**
```
Error: Maximum for --concurrency is 16 (number of cores on this system)
```

**Fix applied:**
```typescript
// Removed setConcurrency - let Remotion auto-detect
Config.setVideoImageFormat('jpeg');
Config.setOverwriteOutput(true);
Config.setCodec('h264');
// ✅ No setConcurrency - uses default
```

**Lesson:** Don't hardcode concurrency, let Remotion auto-detect

---

## Secondary Issues

### 4. No Build Verification

**Issue:** Neither agent verified the project actually builds/renders

**What should have happened:**
1. Setup completes
2. Agent runs `npm start` to verify Studio opens
3. Agent checks for errors
4. Agent reports success/failure

**What actually happened:**
1. Setup completes
2. Agent says "done!"
3. User tries to build
4. Everything fails

**Lesson:** Agents should verify their output works

---

### 5. No Error Handling Guidance

**Issue:** When build failed, user had to debug manually

**What should exist:**
- Common error messages documented
- Troubleshooting steps
- Automatic error diagnosis

**What actually exists:**
- Nothing - user on their own

**Lesson:** Need remotion-debugger agent (as recommended in audit)

---

### 6. Template/Boilerplate Errors

**Issue:** The agent's "default" templates had bugs

**Problems found:**
- Missing CSS imports
- Missing flex classes
- Hardcoded concurrency

**Root cause:** Agent system prompts don't include complete, tested templates

**Lesson:** System prompts need production-ready code templates

---

## Component-by-Component Analysis

### remotion-setup Agent

**What it did:**
- ✅ Created directory structure
- ✅ Installed dependencies
- ✅ Created tsconfig.json
- ✅ Created remotion.config.ts
- ✅ Initialized Tailwind

**What it failed to do:**
- ❌ Import CSS in entry point
- ❌ Set correct concurrency
- ❌ Verify build works
- ❌ Test that Studio opens

**System prompt gaps:**
- No CSS import checklist
- No verification automation
- No error handling
- Hardcoded values instead of auto-detection

---

### remotion-builder Agent

**What it did:**
- ✅ Created TypeScript components
- ✅ Used useCurrentFrame() correctly
- ✅ Used interpolate() and spring() properly
- ✅ Added Tailwind classes
- ✅ Created proper component props

**What it failed to do:**
- ❌ Add `flex` class before flexbox utilities
- ❌ Verify Tailwind setup works
- ❌ Test component rendering
- ❌ Check for common mistakes

**System prompt gaps:**
- No Tailwind gotchas documented
- No component testing checklist
- No visual verification
- No common mistake prevention

---

## Pattern Analysis: Why These Failed

### Generic System Prompts

**Current remotion-builder prompt:**
- ~600 words
- Generic instructions: "use Tailwind classes"
- No specific patterns
- No checklist
- No common gotchas

**Should be:**
- 1500-2000 words
- Specific templates with complete code
- Pre/post generation checklists
- Common gotcha prevention
- Automated verification

### Missing Domain Knowledge

**Tailwind + Remotion Integration:**
The agent didn't know that:
- AbsoluteFill needs `flex` for centering
- CSS must be imported in entry point
- Tailwind requires PostCSS processing
- Classes won't work without proper setup

**Remotion Configuration:**
The agent didn't know that:
- Concurrency should auto-detect
- Different systems have different core counts
- Hardcoded values cause failures
- Config should be minimal

---

## Required Agent Improvements

### remotion-setup Agent Additions

**1. Add Complete Entry Point Template:**
```markdown
### Entry Point Template (src/index.tsx)

ALWAYS create with this exact structure:

```typescript
import {registerRoot} from 'remotion';
import {RemotionRoot} from './Root';
import './style.css';  // CRITICAL: Must import CSS for Tailwind

registerRoot(RemotionRoot);
```

CHECKLIST:
- [ ] Imports registerRoot
- [ ] Imports RemotionRoot
- [ ] Imports style.css (REQUIRED for Tailwind)
- [ ] Calls registerRoot()
```

**2. Fix remotion.config.ts Template:**
```markdown
### remotion.config.ts Template

NEVER hardcode setConcurrency - it varies by system:

```typescript
import {Config} from '@remotion/cli/config';

Config.setVideoImageFormat('jpeg');
Config.setOverwriteOutput(true);
Config.setCodec('h264');
// Let Remotion auto-detect concurrency based on CPU cores
```

DON'T:
- ❌ Config.setConcurrency(50) - fails on systems with fewer cores

DO:
- ✅ Omit setConcurrency - auto-detects correctly
- ✅ Or use: Config.setConcurrency(null) for auto-detect
```

**3. Add Verification Automation:**
```markdown
### After Setup Verification

After creating all files, VERIFY the setup works:

```bash
# 1. Check TypeScript compiles
npx tsc --noEmit

# 2. Try to start Studio (background, 5 second timeout)
timeout 5 npm start &
STUDIO_PID=$!
sleep 3

# 3. Check if process is running
if ps -p $STUDIO_PID > /dev/null; then
  echo "✅ Studio started successfully"
  kill $STUDIO_PID
else
  echo "❌ Studio failed to start - check for errors"
  exit 1
fi
```

ALWAYS verify before reporting success.
```

---

### remotion-builder Agent Additions

**1. Add Tailwind + Remotion Patterns Section:**
```markdown
### Tailwind CSS with Remotion

CRITICAL RULES when using Tailwind with AbsoluteFill:

**Rule 1: AbsoluteFill + Centering**
```typescript
// ❌ WRONG - items-center/justify-center won't work
<AbsoluteFill className="items-center justify-center">

// ✅ CORRECT - must add 'flex' first
<AbsoluteFill className="flex items-center justify-center">
```

**Rule 2: AbsoluteFill + Flexbox Layouts**
```typescript
// Always add display utilities when using flex utilities:
<AbsoluteFill className="flex flex-col items-center">  // ✅
<AbsoluteFill className="flex flex-row justify-between"> // ✅
<AbsoluteFill className="grid grid-cols-2">             // ✅
```

**Rule 3: Background Gradients**
```typescript
// Gradients work without flex
<AbsoluteFill className="bg-gradient-to-br from-blue-900 to-blue-800">
// ✅ This works for background only
```

**Common Mistakes:**
- Forgetting `flex` before `items-center`
- Forgetting `flex` before `justify-center`
- Using flexbox utilities on non-flex containers
```

**2. Add Pre-Generation Checklist:**
```markdown
### Before Generating Components

Verify Tailwind is properly configured:

CHECKLIST:
- [ ] style.css exists with @tailwind directives
- [ ] style.css is imported in entry point (index.tsx or Root.tsx)
- [ ] tailwind.config.js has content paths configured
- [ ] PostCSS is configured (postcss.config.js)

If any are missing, STOP and fix setup first.
```

**3. Add Post-Generation Checklist:**
```markdown
### After Generating Components

CHECKLIST for every component:

Layout:
- [ ] AbsoluteFill with centering has `flex` class
- [ ] All flexbox utilities have display class (flex/grid)
- [ ] No orphaned flex utilities

Animations:
- [ ] Uses useCurrentFrame() for all animations
- [ ] Uses interpolate() or spring() (no CSS animations)
- [ ] Has proper extrapolation (clamp, extend, etc.)

TypeScript:
- [ ] Proper prop types defined
- [ ] No 'any' types
- [ ] Exports are correct

Remotion:
- [ ] Imports from 'remotion' not 'react'
- [ ] Uses Remotion components (AbsoluteFill, Sequence, etc.)
- [ ] Frame calculations are correct
```

**4. Add Component Template Library:**
```markdown
### Centered Content Component Template

Use this template for centered content with Tailwind:

```typescript
import {AbsoluteFill, useCurrentFrame, interpolate} from 'remotion';

export const ComponentName: React.FC = () => {
  const frame = useCurrentFrame();

  const opacity = interpolate(frame, [0, 15], [0, 1], {
    extrapolateRight: 'clamp',
  });

  return (
    <AbsoluteFill className="flex items-center justify-center bg-gradient-to-br from-gray-900 to-gray-800">
      <div style={{opacity}} className="text-center">
        {/* Content here */}
      </div>
    </AbsoluteFill>
  );
};
```

CRITICAL: Notice the `flex` class on AbsoluteFill!
```

---

## Configuration Issues

### remotion.config.ts Best Practices

**Current agent template (WRONG):**
```typescript
Config.setConcurrency(50);  // ❌ Hardcoded - fails on most systems
```

**Should be:**
```typescript
// Option 1: Omit entirely (recommended)
// Remotion auto-detects based on CPU cores

// Option 2: Set to null for explicit auto-detect
Config.setConcurrency(null);

// Option 3: Set to safe percentage
Config.setConcurrency(Math.floor(require('os').cpus().length * 0.8));
```

**Lesson:** Never hardcode system-dependent values

---

### package.json Scripts

**Current agent template (INCOMPLETE):**
```json
{
  "scripts": {
    "start": "remotion studio",
    "build": "remotion render Main out/video.mp4"
  }
}
```

**Should include entry point:**
```json
{
  "scripts": {
    "start": "remotion studio src/index.tsx",
    "build": "remotion render src/index.tsx Main out/video.mp4"
  }
}
```

**Lesson:** All scripts need entry point specified

---

## Testing Methodology Failures

### What We Should Have Done

**Proper testing workflow:**
1. Agent generates code
2. Agent runs `npx tsc --noEmit` to check TypeScript
3. Agent runs `npm start` to verify Studio opens
4. Agent checks for console errors
5. Agent runs quick render test
6. Agent reports: "✅ Verified working" or "❌ Found issues: [list]"

**What actually happened:**
1. Agent generated code
2. Agent said "done!"
3. User tried to build
4. Everything failed
5. Manual debugging required

**Lesson:** Agents must verify their output works, not just assume it does

---

## Recommendations for Agent Improvements

### Priority 1: Expand System Prompts (CRITICAL)

**remotion-setup Agent:**
- Current: ~195 lines (~1000 words)
- Target: 300+ lines (1500-2000 words)
- Add: Complete templates, checklists, verification steps

**remotion-builder Agent:**
- Current: ~87 lines (~600 words)
- Target: 250+ lines (1500-2000 words)
- Add: Code templates, Tailwind patterns, common gotchas, post-generation checklist

**Time estimate:** 3-4 hours

---

### Priority 2: Add Automated Verification (HIGH)

Both agents should:
1. Check TypeScript compiles
2. Start Remotion Studio (background)
3. Check for console errors
4. Report results
5. Only claim success if verified

**Time estimate:** 2-3 hours

---

### Priority 3: Create remotion-debugger Agent (HIGH)

**Why needed:** When things fail, users need help debugging

**Capabilities:**
- Diagnose common errors
- Check configuration
- Validate component structure
- Suggest fixes

**Time estimate:** 3-4 hours

---

### Priority 4: Add Template Library (MEDIUM)

Create tested, production-ready templates for:
- Entry point (index.tsx)
- Root component
- Basic components (TitleCard, TextReveal, etc.)
- Configuration files
- Common patterns

**Time estimate:** 2-3 hours

---

## Specific Code Patterns to Add

### Pattern 1: AbsoluteFill with Tailwind Centering

**MUST include in remotion-builder system prompt:**

```markdown
### CRITICAL: AbsoluteFill + Tailwind Flexbox

When using Tailwind flexbox utilities with AbsoluteFill:

✅ ALWAYS include 'flex' class:
```typescript
<AbsoluteFill className="flex items-center justify-center">

❌ NEVER omit 'flex':
<AbsoluteFill className="items-center justify-center">  // WON'T WORK
```

This is the #1 most common mistake when combining Remotion + Tailwind.
```

---

### Pattern 2: CSS Import in Entry Point

**MUST include in remotion-setup system prompt:**

```markdown
### CRITICAL: Entry Point Structure

The entry point (src/index.tsx) MUST import CSS:

```typescript
import {registerRoot} from 'remotion';
import {RemotionRoot} from './Root';
import './style.css';  // ⚠️ REQUIRED for Tailwind CSS

registerRoot(RemotionRoot);
```

Without the CSS import, Tailwind classes won't load and components will render incorrectly.

CHECKLIST after creating index.tsx:
- [ ] Imports registerRoot
- [ ] Imports RemotionRoot
- [ ] Imports style.css ← CHECK THIS
- [ ] Calls registerRoot()
```

---

### Pattern 3: Safe Configuration Defaults

**MUST include in remotion-setup system prompt:**

```markdown
### CRITICAL: remotion.config.ts Defaults

NEVER hardcode system-dependent values:

❌ DON'T:
```typescript
Config.setConcurrency(50);  // Fails on systems with fewer cores
```

✅ DO:
```typescript
// Option 1: Omit entirely (recommended)
// Remotion auto-detects optimal concurrency

// Option 2: Set to null for explicit auto-detect
Config.setConcurrency(null);
```

Always use auto-detection for:
- Concurrency (CPU cores)
- Memory limits
- Other system resources
```

---

## Documentation Gaps in remotion-best-practices Skill

The skill has 29 rule files but missed these critical topics:

### Missing: Tailwind Integration Gotchas

**Should add:** `rules/tailwind-remotion-integration.md`

Content should cover:
- AbsoluteFill + flex classes
- Common centering mistakes
- CSS import requirements
- PostCSS configuration
- Gradient backgrounds
- Responsive utilities

### Missing: Common Mistakes Guide

**Should add:** `rules/common-mistakes.md`

Content should cover:
- Missing CSS imports
- Missing flex classes
- Hardcoded system values
- CSS animations (forbidden)
- Incorrect frame calculations
- Wrong import sources

### Missing: Troubleshooting Guide

**Should add:** `rules/troubleshooting.md`

Content should cover:
- Black screen issues
- Content not centering
- Animations not working
- Build failures
- Studio not opening
- Common error messages

---

## Impact on Plugin Quality

### Before Real-World Test

**Status:** "Production Ready ✅" (based on audits)

**Confidence:** High - passed all validation checks

**Reality:** Would fail immediately on first use

### After Real-World Test

**Status:** "Needs Major Improvements ⚠️"

**Confidence:** Low - generates broken code

**Reality:** Agents produce non-functional output

**Lesson:** Code audits ≠ real-world testing. Always dogfood your tools.

---

## Recommended Action Plan

### Immediate (Block v1.0 Release)

1. **Fix remotion-setup agent** (2 hours)
   - Add complete entry point template with CSS import
   - Remove setConcurrency from config template
   - Add automated verification

2. **Fix remotion-builder agent** (2 hours)
   - Add Tailwind + Remotion patterns section
   - Add pre/post generation checklists
   - Add component templates with all required classes

3. **Add skill rules** (2 hours)
   - Create tailwind-remotion-integration.md
   - Create common-mistakes.md
   - Create troubleshooting.md

**Total time:** 6 hours to make plugin actually functional

---

### Short-term (v1.1)

4. **Create remotion-debugger agent** (4 hours)
   - Diagnose common errors
   - Validate configurations
   - Suggest fixes

5. **Add automated testing to agents** (3 hours)
   - TypeScript compilation checks
   - Studio startup verification
   - Component render validation

6. **Expand system prompts** (3 hours)
   - remotion-builder: 600 → 1500-2000 words
   - Add complete code templates
   - Add error prevention patterns

**Total time:** 10 hours

---

### Long-term (v2.0)

7. **Create tested template library**
   - Production-ready component templates
   - Tested configurations
   - Working examples

8. **Add progressive disclosure to skill**
   - references/ for concepts
   - rules/ for quick reference
   - examples/ for complete code

9. **Add visual regression testing**
   - Automated screenshot comparison
   - Catch rendering issues
   - Verify animations work

---

## Lessons for Future Plugin Development

### 1. Always Dogfood First

**Don't:**
- Build plugin → audit structure → call it "production ready"
- Trust that code "should work"
- Skip real-world testing

**Do:**
- Build plugin → use it for real task → find issues → fix → test again
- Verify output actually works
- Test with real-world scenarios

---

### 2. System Prompts Need Production Code

**Don't:**
- Generic instructions: "use Tailwind classes"
- Assume agent knows common gotchas
- Expect agent to figure things out

**Do:**
- Include complete, tested code templates
- Document every common mistake
- Provide copy-paste patterns that work
- Include checklists for verification

---

### 3. Agents Must Verify Their Output

**Don't:**
- Generate code → report success
- Trust that code works
- Leave debugging to users

**Do:**
- Generate code → verify it compiles → verify it runs → report results
- Catch errors before user sees them
- Provide automated diagnostics

---

### 4. Audits Aren't Enough

**What audits check:**
- ✅ Structure correct
- ✅ Frontmatter valid
- ✅ Files present
- ✅ Naming conventions

**What audits miss:**
- ❌ Does generated code actually work?
- ❌ Are templates production-ready?
- ❌ Will users succeed on first try?
- ❌ Are common mistakes prevented?

**Lesson:** Audits validate structure, not functionality. Must test in practice.

---

## Quantified Failure Analysis

### User Experience

**Expected:**
1. Run `/remotion-max:setup` → Works ✓
2. Run `/remotion-max:builder` → Gets working code ✓
3. Run `npm run build` → Gets polished video ✓

**Actual:**
1. Run `/remotion-max:setup` → Creates broken config ✗
2. Run `/remotion-max:builder` → Generates broken components ✗
3. Run `npm run build` → Error (concurrency) ✗
4. Fix concurrency → Build succeeds → Black screen ✗
5. Manual debugging required → Find 2 more critical bugs ✗
6. Manual fixes applied → Rebuild → Success ✓

**First-try success rate:** 0%
**Manual interventions required:** 3+
**User frustration level:** High

---

### Code Quality

**Generated code quality:**
- TypeScript: ✅ Valid
- Remotion patterns: ✅ Correct
- Animations: ✅ Properly implemented
- Visual output: ❌ Completely broken

**Root cause:** Correct patterns used incorrectly (missing flex, missing CSS import)

---

## Comparison: Audit vs Reality

| Aspect | Audit Said | Reality Was |
|--------|-----------|-------------|
| Plugin status | Production Ready ✅ | Generates broken code ✗ |
| Agent quality | Needs minor improvements | Fundamentally broken ✗ |
| System prompts | Too brief but functional | Missing critical patterns ✗ |
| Templates | Could be better | Don't work at all ✗ |
| First-try success | Not assessed | 0% ✗ |

**Gap:** Audits check structure, not whether generated code works.

---

## Success Criteria for v1.0 (Revised)

Before calling remotion-max "production ready":

### Must Pass:
- [ ] Create 3 different test videos from scratch
- [ ] Each video must render correctly on first try
- [ ] No manual fixes required
- [ ] No build errors
- [ ] Visual output matches expectations
- [ ] Agents verify their own output

### Quality Metrics:
- **First-try success rate:** 90%+ (currently 0%)
- **Manual interventions:** 0-1 (currently 3+)
- **Build errors:** 0 (currently 1)
- **Visual bugs:** 0 (currently 2)

---

## Files to Update

Based on this test, update these files:

1. **remotion-max/agents/remotion-setup.md**
   - Add complete entry point template with CSS import
   - Fix remotion.config.ts template (remove setConcurrency)
   - Add verification automation
   - Expand from 195 → 300+ lines

2. **remotion-max/agents/remotion-builder.md**
   - Add Tailwind + Remotion patterns section
   - Add pre/post generation checklists
   - Add component templates
   - Expand from 87 → 250+ lines

3. **remotion-max/skills/remotion-best-practices/**
   - Add rules/tailwind-remotion-integration.md
   - Add rules/common-mistakes.md
   - Add rules/troubleshooting.md

4. **Create new agent:**
   - remotion-max/agents/remotion-debugger.md
   - For diagnosing and fixing issues

---

## Conclusion

**This test was invaluable.** We discovered that:

1. ✅ **Plugin structure is correct** (validation passed)
2. ❌ **Generated code is broken** (3 critical bugs)
3. ❌ **Agents lack essential knowledge** (missing patterns)
4. ❌ **No verification automation** (assumes code works)
5. ❌ **System prompts too generic** (need specific templates)

**The good news:** These are all fixable. The issues are well-defined and the solutions are clear.

**The bad news:** remotion-max isn't production-ready yet. It needs significant improvements before users can rely on it.

**Estimated effort to fix:** 10-15 hours of focused work

**Next steps:**
1. Fix the explainer video (validate fixes work)
2. Update agent system prompts with all patterns
3. Add missing skill rules
4. Test again with 2-3 more videos
5. Achieve 90%+ first-try success rate
6. THEN call it production-ready

---

## Positive Takeaways

**What worked well:**
- ✅ Plugin structure (marketplace, manifest, agents, commands)
- ✅ Installation process (worked perfectly)
- ✅ Agent triggering (examples worked)
- ✅ TypeScript compilation (no errors)
- ✅ Remotion API usage (correct patterns)
- ✅ Animation code (proper interpolate/spring)

**What this proves:**
- ✅ Our marketplace structure is solid
- ✅ Agent discovery system works
- ✅ The skill content is accurate
- ✅ Command/agent integration works

**The core is good** - we just need to improve the generated code quality.

---

**Created by:** Real-world testing of remotion-max plugin
**Date:** 2026-02-04
**Outcome:** Critical improvements identified
**Status:** Actionable improvement plan created
